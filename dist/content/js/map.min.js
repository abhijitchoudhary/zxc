var clicks=[];!function(a){var b=new L.Map("map",{center:[40.7,-74.3],zoom:11,minZoom:8,maxZoom:13,attributionControl:!1}),c=(new L.TileLayer("https://api.mapbox.com/styles/v1/ddcreative/ciwwekdvl004e2qrxzd4vqats/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiZGRjcmVhdGl2ZSIsImEiOiJjaXU4aWp6dWIwMDgyMnNwZHN0eTN3bGtzIn0.JSbKaBx8Pu9Xtf4YxhT-sQ").addTo(b),L.Icon.extend({options:{iconSize:[16,16],iconAnchor:[8,8],popupAnchor:[0,-8]}})),d=new c({iconUrl:"content/img/ui/marker-icon-2x.png"}),e=new c({iconUrl:"content/img/ui/marker-zone-a-2x.png"}),f=new c({iconUrl:"content/img/ui/marker-zone-b-2x.png"}),g=new c({iconUrl:"content/img/ui/marker-zone-c-2x.png"}),h=(L.geoJson(locationsJSON,{onEachFeature:function(b,c){var h="";b.properties.message&&(h='<span class="marker-message">'+b.properties.message+"</span>"),c.bindPopup("<b>Address:</b> "+b.properties.name+"<br><b>Datacenter:</b> "+b.properties.datacenter+"<br><b>Zone:</b> "+b.properties.zone+"<br>"+h,{autoClose:!1}),c.on("mouseover",function(a){this.openPopup()}),c.on("mouseout",function(b){a.inArray(b.target._leaflet_id,clicks)===-1&&this.closePopup()}),b.properties.zone&&"1"===b.properties.zone?c.setIcon(e):b.properties.zone&&"2"===b.properties.zone?c.setIcon(f):b.properties.zone&&"3"===b.properties.zone&&c.setIcon(g),c.on("click",function(a){clicks[clicks.length]=a.target._leaflet_id,c.setIcon(d),this.openPopup()})}}).addTo(b),L.geoJSON(zonesJSON,{style:function(a){switch(a.properties.zone){case"1":return{fillColor:"#2c4498",fillOpacity:.5,color:"#7f7f7f",weight:2};case"2":return{fillColor:"#a5cd39",fillOpacity:.5,color:"#7f7f7f",weight:2};case"3":return{fillColor:"#424242",fillOpacity:.5,color:"#7f7f7f",weight:2}}}}).addTo(b)),i=L.geoJson(zoneLabelJSON,{onEachFeature:function(a,b){var c=L.divIcon({className:"marker--zone-label",iconSize:[40,18],html:a.properties.label});b.setIcon(c)}}).addTo(b),j=L.geoJson(stateLabelJSON,{onEachFeature:function(a,b){var c=L.divIcon({className:"marker--state-label",iconSize:[40,18],html:a.properties.label});b.setIcon(c)}}).addTo(b);b.on("zoomend",function(a){var c=b.getZoom();c<10?b.removeLayer(i):b.addLayer(i),c<9?b.removeLayer(j):b.addLayer(j)}),b.fitBounds(h.getBounds())}(jQuery);